<!--
  ------------------------------------------------------------
  File: index.html
  Path: /index.html
  Description:
    Root HTML entry for the MyTubes PWA.
    - Correct base path for GitHub Pages (/MyTubes/)
    - Correct manifest + icons
    - Correct YouTube iframe API
    - Correct Vite module entry (rewritten on build)
    - CSP updated with worker-src to allow service worker
  ------------------------------------------------------------
-->

<!DOCTYPE html>
<html lang="en" style="background:#000;">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- PWA Manifest -->
    <link rel="manifest" href="/MyTubes/manifest.json" />

    <!-- iOS PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="MyTube" />
    <link rel="apple-touch-icon" href="/MyTubes/favicon.png" />

    <!-- CSP (allows YouTube embeds + inline scripts + service worker) -->
    <meta
      http-equiv="Content-Security-Policy"
      content="
        default-src * 'unsafe-inline' 'unsafe-eval' blob: data:;
        img-src * data: blob:;
        media-src *;
        script-src * 'unsafe-inline' 'unsafe-eval'
          https://www.youtube.com
          https://www.youtube-nocookie.com
          https://www.youtube.com/s/;
        frame-src https://www.youtube.com https://www.youtube-nocookie.com https://www.youtube.com/s/;
        child-src https://www.youtube.com https://www.youtube-nocookie.com https://www.youtube.com/s/;
        worker-src 'self' blob:;
      "
    />

    <!-- YouTube Player API -->
    <script async src="https://www.youtube.com/iframe_api"></script>

    <title>MyTube</title>
    <link rel="icon" type="image/png" href="/MyTubes/favicon.png" />
  </head>

  <body style="background:#000; margin:0; padding:0;">
    <!-- React mounts here -->
    <div id="root"></div>

    <!--
      ⭐ IMPORTANT:
      This is the correct Vite dev entry.
      Vite will rewrite this to /MyTubes/assets/index-xxxxx.js during build.
    -->
    <script type="module" src="/src/main.jsx"></script>

    <!-- GitHub Pages–compatible Service Worker -->
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("/MyTubes/sw.js")
          .catch(err => console.log("SW registration failed:", err));
      }
    </script>
  </body>
</html>
